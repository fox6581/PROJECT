{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.every.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.some.js\";\nimport { ref } from 'vue';\nimport CategoryFilter from './CategoryFilter.vue';\nimport BrandFilter from './BrandFilter.vue';\nimport CharacteristicFilter from './CharacteristicFilter.vue';\nexport default {\n  __name: 'ProductFilter',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const selectedCategories = ref([]);\n    const selectedBrands = ref([]);\n    const selectedCharacteristics = ref({});\n    const filteredProducts = computed(() => {\n      console.log('начало работы фильтрации');\n      if (selectedBrands.value.length === 0 && Object.keys(selectedCharacteristics.value).length === 0 && selectedCategorys.value.length === 0) {\n        return products.value; // Возвращаем все товары, если ничего не выбрано\n      }\n      return products.value.filter(product => {\n        const matchesBrand = selectedBrands.value.length === 0 || selectedBrands.value.includes(product.brand);\n        const matchesCategory = selectedCategorys.value.length === 0 || selectedCategorys.value.includes(product.category);\n        const matchesCharacteristics = Object.keys(selectedCharacteristics.value).every(characteristic => {\n          if (!selectedCharacteristics.value[characteristic] || selectedCharacteristics.value[characteristic].length === 0) {\n            return true; // Если характеристика не выбрана, пропускаем\n          }\n          const selectedValues = Array.isArray(selectedCharacteristics.value[characteristic]) ? selectedCharacteristics.value[characteristic] : [selectedCharacteristics.value[characteristic]];\n          const productValues = product.characteristics ? product.characteristics.filter(item => item.characteristic === characteristic).map(item => item.value) : [];\n          return selectedValues.some(value => productValues.includes(value));\n        });\n        return matchesBrand && matchesCategory && matchesCharacteristics;\n      });\n    });\n    const loadCategories = async () => {\n      try {\n        const response = await fetch('http://localhost:1452/api/products');\n        if (!response.ok) {\n          throw new Error('Ошибка при загрузке категорий');\n        }\n        const data = await response.json();\n        categories.value = data;\n        extractBrands(data);\n        extractCategorys(data);\n        extractCharacteristics(data);\n      } catch (error) {\n        console.error('Ошибка при загрузке категорий:', error);\n      }\n    };\n    const __returned__ = {\n      selectedCategories,\n      selectedBrands,\n      selectedCharacteristics,\n      filteredProducts,\n      loadCategories,\n      ref,\n      CategoryFilter,\n      BrandFilter,\n      CharacteristicFilter\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","CategoryFilter","BrandFilter","CharacteristicFilter","selectedCategories","selectedBrands","selectedCharacteristics","filteredProducts","computed","console","log","value","length","Object","keys","selectedCategorys","products","filter","product","matchesBrand","includes","brand","matchesCategory","category","matchesCharacteristics","every","characteristic","selectedValues","Array","isArray","productValues","characteristics","item","map","some","loadCategories","response","fetch","ok","Error","data","json","categories","extractBrands","extractCategorys","extractCharacteristics","error"],"sources":["C:/shopvue/front-vue3/src/components/Filter/ProductFilter.vue"],"sourcesContent":["<template>\r\n    <CategoryFilter :selected=\"selectedCategories\" @change=\"handleCategoryChange\" />\r\n    <BrandFilter :brands=\"brands\" :selected=\"selectedBrands\" @change=\"handleBrandChange\" />\r\n    <CharacteristicFilter :characteristics=\"characteristics\" :selected=\"selectedCharacteristics\" @change=\"handleCharacteristicChange\" />\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { ref } from 'vue'; \r\n  import CategoryFilter from './CategoryFilter.vue';\r\n  import BrandFilter from './BrandFilter.vue';\r\n  import CharacteristicFilter from './CharacteristicFilter.vue';\r\n  \r\n  const selectedCategories = ref([]);\r\n  const selectedBrands = ref([]);\r\n  const selectedCharacteristics = ref({});\r\n\r\n  const filteredProducts = computed(() => {\r\n    console.log('начало работы фильтрации');\r\n\r\n    if (selectedBrands.value.length === 0 && Object.keys(selectedCharacteristics.value).length === 0 && selectedCategorys.value.length === 0) {\r\n        return products.value; // Возвращаем все товары, если ничего не выбрано\r\n    }\r\n\r\n    return products.value.filter(product => {\r\n        const matchesBrand = selectedBrands.value.length === 0 || selectedBrands.value.includes(product.brand);\r\n        const matchesCategory = selectedCategorys.value.length === 0 || selectedCategorys.value.includes(product.category);\r\n\r\n        const matchesCharacteristics = Object.keys(selectedCharacteristics.value).every(characteristic => {\r\n            if (!selectedCharacteristics.value[characteristic] || selectedCharacteristics.value[characteristic].length === 0) {\r\n                return true; // Если характеристика не выбрана, пропускаем\r\n            }\r\n\r\n            const selectedValues = Array.isArray(selectedCharacteristics.value[characteristic])\r\n                ? selectedCharacteristics.value[characteristic]\r\n                : [selectedCharacteristics.value[characteristic]];\r\n\r\n            const productValues = product.characteristics\r\n                ? product.characteristics\r\n                    .filter(item => item.characteristic === characteristic)\r\n                    .map(item => item.value)\r\n                : [];\r\n\r\n            return selectedValues.some(value => productValues.includes(value));\r\n        });\r\n\r\n        return matchesBrand && matchesCategory && matchesCharacteristics;\r\n    });\r\n});\r\nconst loadCategories = async () => {\r\n    try {\r\n        const response = await fetch('http://localhost:1452/api/products');\r\n        if (!response.ok) {\r\n            throw new Error('Ошибка при загрузке категорий');\r\n        }\r\n        const data = await response.json();\r\n        categories.value = data;\r\n\r\n        extractBrands(data);\r\n        extractCategorys(data);\r\n        extractCharacteristics(data);\r\n    } catch (error) {\r\n        console.error('Ошибка при загрузке категорий:', error);\r\n    }\r\n};\r\n\r\n  </script>\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}