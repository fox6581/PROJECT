{"ast":null,"code":"import { ref, reactive, watch, onMounted } from 'vue';\nexport default {\n  __name: 'MenuPrice',\n  props: {\n    initialMinValue: {\n      type: Number,\n      default: 100\n    },\n    initialMaxValue: {\n      type: Number,\n      default: 1000\n    },\n    rangeMin: {\n      type: Number,\n      default: 0\n    },\n    rangeMax: {\n      type: Number,\n      default: 10000\n    }\n  },\n  emits: ['update:filter'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const filter = ref({\n      min: 100,\n      max: 1000\n    });\n    const sliderContainer = ref(null);\n    const minBlock = ref(null);\n    const maxBlock = ref(null);\n    const colorRangeStyle = reactive({\n      left: '0px',\n      width: '100px'\n    });\n    const minValue = ref(props.initialMinValue);\n    const maxValue = ref(props.initialMaxValue);\n    let activeElement = null;\n    function startMoveRange(type) {\n      activeElement = type;\n      document.addEventListener('mousemove', onMouseMove);\n      document.addEventListener('mouseup', onMouseUp);\n      document.addEventListener('touchmove', onMouseMove);\n      document.addEventListener('touchend', onMouseUp);\n    }\n    function getCoords(elem) {\n      const coords = elem.getBoundingClientRect();\n      return {\n        left: coords.left + window.pageXOffset,\n        width: coords.width\n      };\n    }\n    function onMouseMove(e) {\n      const sliderCoords = getCoords(sliderContainer.value);\n      const blockCoords = activeElement === 'min' ? getCoords(maxBlock.value) : getCoords(minBlock.value);\n      let posX = e.touches ? e.touches[0].clientX : e.clientX;\n      let newLeft = posX - sliderCoords.left;\n      if (activeElement === 'min') {\n        newLeft = Math.max(0, Math.min(newLeft, blockCoords.left - sliderCoords.left - minBlock.value.offsetWidth));\n        minBlock.value.style.left = `${newLeft}px`;\n        minValue.value = (newLeft / sliderCoords.width * (props.rangeMax - props.rangeMin) + props.rangeMin).toFixed(1);\n      } else {\n        newLeft = Math.min(sliderCoords.width - maxBlock.value.offsetWidth, Math.max(newLeft, blockCoords.left - sliderCoords.left));\n        maxBlock.value.style.left = `${newLeft}px`;\n        maxValue.value = (newLeft / sliderCoords.width * (props.rangeMax - props.rangeMin) + props.rangeMin).toFixed(1);\n      }\n      updateColorRange();\n    }\n    function onMouseUp() {\n      document.removeEventListener('mousemove', onMouseMove);\n      document.removeEventListener('mouseup', onMouseUp);\n      document.removeEventListener('touchmove', onMouseMove);\n      document.removeEventListener('touchend', onMouseUp);\n    }\n    function updateColorRange() {\n      const minLeft = minBlock.value.offsetLeft;\n      const maxLeft = maxBlock.value.offsetLeft;\n      colorRangeStyle.left = `${minLeft}px`;\n      colorRangeStyle.width = `${maxLeft - minLeft}px`;\n    }\n    function onInputChange(type) {\n      const sliderWidth = getCoords(sliderContainer.value).width;\n      const blockWidth = minBlock.value.offsetWidth;\n      if (type === 'min') {\n        const newLeft = (minValue.value - props.rangeMin) / (props.rangeMax - props.rangeMin) * sliderWidth;\n        minBlock.value.style.left = `${Math.max(0, Math.min(newLeft, sliderWidth - blockWidth))}px`;\n      } else {\n        const newLeft = (maxValue.value - props.rangeMin) / (props.rangeMax - props.rangeMin) * sliderWidth;\n        maxBlock.value.style.left = `${Math.max(0, Math.min(newLeft, sliderWidth - blockWidth))}px`;\n      }\n      updateColorRange();\n    }\n\n    // Отправляем значения фильтра\n    const emit = __emit;\n    watch([minValue, maxValue], ([newMin, newMax]) => {\n      emit('update:filter', {\n        min: newMin,\n        max: newMax\n      });\n    });\n    onMounted(() => {\n      updateColorRange();\n    });\n    const __returned__ = {\n      props,\n      filter,\n      sliderContainer,\n      minBlock,\n      maxBlock,\n      colorRangeStyle,\n      minValue,\n      maxValue,\n      get activeElement() {\n        return activeElement;\n      },\n      set activeElement(v) {\n        activeElement = v;\n      },\n      startMoveRange,\n      getCoords,\n      onMouseMove,\n      onMouseUp,\n      updateColorRange,\n      onInputChange,\n      emit,\n      ref,\n      reactive,\n      watch,\n      onMounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","watch","onMounted","props","__props","filter","min","max","sliderContainer","minBlock","maxBlock","colorRangeStyle","left","width","minValue","initialMinValue","maxValue","initialMaxValue","activeElement","startMoveRange","type","document","addEventListener","onMouseMove","onMouseUp","getCoords","elem","coords","getBoundingClientRect","window","pageXOffset","e","sliderCoords","value","blockCoords","posX","touches","clientX","newLeft","Math","offsetWidth","style","rangeMax","rangeMin","toFixed","updateColorRange","removeEventListener","minLeft","offsetLeft","maxLeft","onInputChange","sliderWidth","blockWidth","emit","__emit","newMin","newMax"],"sources":["C:/shopvue/front-vue3/src/components/Menu/MenuPrice.vue"],"sourcesContent":["<template>\r\n    <div class=\"filter\">\r\n      <div>\r\n        <span>Фильтр</span>\r\n        <div class=\"price-inputs\">\r\n          <label>\r\n            Минимальная цена:\r\n            <input type=\"number\" v-model=\"minValue\" @input=\"onInputChange('min')\" />\r\n          </label>\r\n          <label>\r\n            Максимальная цена:\r\n            <input type=\"number\" v-model=\"maxValue\" @input=\"onInputChange('max')\" />\r\n          </label>\r\n        </div>\r\n        <div id=\"rating\" class=\"slider\" ref=\"sliderContainer\">\r\n          <div\r\n            class=\"block-min\"\r\n            ref=\"minBlock\"\r\n            @mousedown=\"startMoveRange('min')\"\r\n            @touchstart=\"startMoveRange('min')\"\r\n          ></div>\r\n          <div class=\"color-range\" :style=\"colorRangeStyle\"></div>\r\n          <div\r\n            class=\"block-max\"\r\n            ref=\"maxBlock\"\r\n            @mousedown=\"startMoveRange('max')\"\r\n            @touchstart=\"startMoveRange('max')\"\r\n          ></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { ref, reactive, watch, onMounted, defineProps, defineEmits} from 'vue';\r\n  \r\n  const props = defineProps({\r\n    initialMinValue: {\r\n      type: Number,\r\n      default: 100\r\n    },\r\n    initialMaxValue: {\r\n      type: Number,\r\n      default: 1000\r\n    },\r\n    rangeMin: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n    rangeMax: {\r\n      type: Number,\r\n      default: 10000\r\n    }\r\n  });\r\n  \r\n  const filter = ref({ min: 100, max: 1000 });\r\n  const sliderContainer = ref(null);\r\n  const minBlock = ref(null);\r\n  const maxBlock = ref(null);\r\n  const colorRangeStyle = reactive({ left: '0px', width: '100px' });\r\n  \r\n  const minValue = ref(props.initialMinValue);\r\n  const maxValue = ref(props.initialMaxValue);\r\n  \r\n  let activeElement = null;\r\n  \r\n  function startMoveRange(type) {\r\n    activeElement = type;\r\n    document.addEventListener('mousemove', onMouseMove);\r\n    document.addEventListener('mouseup', onMouseUp);\r\n    document.addEventListener('touchmove', onMouseMove);\r\n    document.addEventListener('touchend', onMouseUp);\r\n  }\r\n  \r\n  function getCoords(elem) {\r\n    const coords = elem.getBoundingClientRect();\r\n    return {\r\n      left: coords.left + window.pageXOffset,\r\n      width: coords.width\r\n    };\r\n  }\r\n  \r\n  function onMouseMove(e) {\r\n    const sliderCoords = getCoords(sliderContainer.value);\r\n    const blockCoords = activeElement === 'min' ? getCoords(maxBlock.value) : getCoords(minBlock.value);\r\n    let posX = e.touches ? e.touches[0].clientX : e.clientX;\r\n    let newLeft = posX - sliderCoords.left;\r\n  \r\n    if (activeElement === 'min') {\r\n      newLeft = Math.max(0, Math.min(newLeft, blockCoords.left - sliderCoords.left - minBlock.value.offsetWidth));\r\n      minBlock.value.style.left = `${newLeft}px`;\r\n      minValue.value = ((newLeft / sliderCoords.width) * (props.rangeMax - props.rangeMin) + props.rangeMin).toFixed(1);\r\n    } else {\r\n      newLeft = Math.min(sliderCoords.width - maxBlock.value.offsetWidth, Math.max(newLeft, blockCoords.left - sliderCoords.left));\r\n      maxBlock.value.style.left = `${newLeft}px`;\r\n      maxValue.value = ((newLeft / sliderCoords.width) * (props.rangeMax - props.rangeMin) + props.rangeMin).toFixed(1);\r\n    }\r\n  \r\n    updateColorRange();\r\n  }\r\n  \r\n  function onMouseUp() {\r\n    document.removeEventListener('mousemove', onMouseMove);\r\n    document.removeEventListener('mouseup', onMouseUp);\r\n    document.removeEventListener('touchmove', onMouseMove);\r\n    document.removeEventListener('touchend', onMouseUp);\r\n  }\r\n  \r\n  function updateColorRange() {\r\n    const minLeft = minBlock.value.offsetLeft;\r\n    const maxLeft = maxBlock.value.offsetLeft;\r\n    colorRangeStyle.left = `${minLeft}px`;\r\n    colorRangeStyle.width = `${maxLeft - minLeft}px`;\r\n  }\r\n  \r\n  function onInputChange(type) {\r\n    const sliderWidth = getCoords(sliderContainer.value).width;\r\n    const blockWidth = minBlock.value.offsetWidth;\r\n  \r\n    if (type === 'min') {\r\n      const newLeft = ((minValue.value - props.rangeMin) / (props.rangeMax - props.rangeMin)) * sliderWidth;\r\n      minBlock.value.style.left = `${Math.max(0, Math.min(newLeft, sliderWidth - blockWidth))}px`;\r\n    } else {\r\n      const newLeft = ((maxValue.value - props.rangeMin) / (props.rangeMax - props.rangeMin)) * sliderWidth;\r\n      maxBlock.value.style.left = `${Math.max(0, Math.min(newLeft, sliderWidth - blockWidth))}px`;\r\n    }\r\n    updateColorRange();\r\n  }\r\n  \r\n  // Отправляем значения фильтра\r\n  const emit = defineEmits(['update:filter']);\r\n  watch([minValue, maxValue], ([newMin, newMax]) => {\r\n    emit('update:filter', { min: newMin, max: newMax });\r\n  });\r\n  \r\n  onMounted(() => {\r\n    updateColorRange();\r\n  });\r\n  </script>\r\n  \r\n\r\n  \r\n  \r\n  <style scoped>\r\n  .filter {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 10px;\r\n  }\r\n  .price-inputs {\r\n    display: flex;\r\n    gap: 20px;\r\n    margin-bottom: 10px;\r\n  }\r\n  .slider {\r\n    position: relative;\r\n    width: 300px;\r\n    height: 10px;\r\n    background: #ddd;\r\n    border-radius: 5px;\r\n    margin-top: 20px;\r\n  }\r\n  .block-min, .block-max {\r\n    position: absolute;\r\n    top: -5px;\r\n    width: 16px;\r\n    height: 16px;\r\n    background: #4CAF50;\r\n    border-radius: 50%;\r\n    cursor: pointer;\r\n  }\r\n  .color-range {\r\n    position: absolute;\r\n    top: 0;\r\n    height: 10px;\r\n    background: #4CAF50;\r\n  }\r\n  </style>\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}